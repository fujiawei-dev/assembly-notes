---
date: 2022-02-03T18:28:13+08:00  # 创建日期
author: "Rustle Karl"  # 作者

# 文章
title: "第3章_汇编语言和汇编软件"  # 文章标题
# description: "文章描述"
url:  "posts/assembly/docs/第1部分_预备知识/第3章_汇编语言和汇编软件"  # 设置网页永久链接
tags: ["assembly", "汇编语言"]  # 标签
series: [ "汇编语言学习笔记"]  # 系列
categories: [ "学习笔记"]  # 分类

# 章节
weight: 20 # 排序优先级
chapter: false  # 设置为章节

index: true  # 是否可以被索引
toc: true  # 是否自动生成目录
draft: false  # 草稿
---

处理器依靠机器指令工作，但机器指令从形式上看都是一些没有规律的数字，难以书写、阅读和理解，这样就发明了汇编语言。

## 汇编语言简介

指令和被指令引用的数据在内存中都是一些或高或低的电平，每一个电平都可以看成是一个二进制位（0 或者1），8 个二进制位形成一字节。

要解读内存中的东西，最好的办法就是将它们按字节转换成数字的形式。比如，下面这些数字就是存放在内存中的INTEL8086 指令，我们用的是十六进制：

```
B8 3F 00 01 C3 01 C1
```

```
将立即数 003FH 传送到寄存器 AX ；
将寄存器 BX 的内容和寄存器 AX 的内容相加，结果在 BX 中；
将寄存器 CX 的内容和寄存器 X 的内容相加，结果在 CX 中。
```

即使是很有经验的技术人员，要想用这种方式来编写指令，也是很困难的，而且很容易出错。所以，在第一个处理器诞生之后不久，如何使指令的编写变得更容易，就提上了日程。

为了克服机器指令难以书写和理解的缺点，人们想到可以用一些容易理解和记忆的符号，也就是助记符，来描述指令的功能和操作数的类型，这就产生了汇编语言（Assembly Language）。这样，上面那些指令就可以写成：

```
mov ax, 3FH
add bx, ax
add cx, ax
```

汇编语言对指令的大小写没有特别的要求。

在很多高级语言中，如果要指示一个数是十六进制数，通常不采用在后面加“H”的做法，而是为它添加一个“0x”前缀。

在汇编语言中，使用十进制数是最自然的。

像上面那样，用汇编语言提供的符号书写的文本，叫做汇编语言源程序。

有了汇编语言所提供的符号，这只是方便了你自己。相反地，对人类来说通俗易懂的东西，处理器是无法识别的。所以，还需要将汇编语言源程序转换成机器指令，这个过程叫做编译（Compile）。在编译的时候，汇编语言编译器的作用是将 mov、add、ax、bx 等这些符号组合起来，转换成类似于数值的机器指令，这个过程叫做汇编，这就是汇编语言的由来，也有人称之为组合语言。

编译肯定还需要依靠一个软件，称为编译器，或编译软件。

从字处理器软件生成的是汇编语言源程序文件。编译软件的任务是读取这些文件，将那些符号转变成二进制形式的机器指令代码。它把这些机器代码存放到另一个文件中，叫做二进制文件或者可执行文件，比如 Windows 里以“.exe”为扩展名的文件，就是可执行文件。当需要用处理器执行的时候，再加载到内存里。

## NASM 编译器

### NASM 的下载和安装

每种处理器都可能会有自己的汇编语言编译器，而对于同一款处理器来说，针对不同的平台（比如 Windows 和 Linux），也会有不同版本的汇编语言编译器。

现存的汇编语言编译器有多种，用得比较多的有 MASM、FASM、TASM、AS86、GASM 等，每种汇编器都有自己的特色和局限性。

NASM 的全称是 Netwide Assembler，它是可免费使用的开源软件。

```
https://www.nasm.us/pub/nasm/releasebuilds
```

### 代码的书写和编译过程

作为惯例，汇编语言源程序文件的扩展名是“.asm”，不过，当然可以使用其他扩展名。

```shell
nasm -f bin exam.asm -o exam.bin
```

NASM 需要一系列参数才能正常工作。-f 参数的作用是指定输出文件的格式（Format）。这样，-f bin 就是要求 NASM 生成的文件只包含“纯二进制”的内容。换句话说，除了处理器能够识别的机器代码外，别的任何东西都不包含。这样一来，因为缺少操作系统所需要的加载和重定位信息，它就很难在 Windows、DOS 和 Linux 上作为一个普通的应用程序运行。

紧接着，exam.asm 是源程序的文件名，它是将要被编译的对象。

-o 参数指定编译后输出（Output）的文件名。在这里，我们要求 NASM 生成输出文件 exam.bin。

### 查看编译后的二进制文件

用 VS Code 插件即可。
